<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Welcome</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  </head>
  <body class="p-4" style='font-family: Lexend, "Noto Sans", sans-serif;'>
    <h1 class="text-2xl font-bold mb-4">Set up your language goals</h1>
    <form id="prefForm" class="flex flex-col gap-4 max-w-sm">
      <input id="lang" name="language" placeholder="Language" required class="rounded-xl bg-[#f0f5f4] p-3" />
      <input id="objective" name="objective" placeholder="Purpose" required class="rounded-xl bg-[#f0f5f4] p-3" />
      <button type="submit" class="rounded-full bg-[#03b39f] text-white py-2">Save</button>
      <button type="button" id="evaluate" class="rounded-full bg-[#5f8c87] text-white py-2">Evaluate level</button>
      <p id="status" class="text-center text-sm text-red-500"></p>
    </form>
    <script>
      const form = document.getElementById('prefForm');
      const statusEl = document.getElementById('status');
      form.addEventListener('submit', async e => {
        e.preventDefault();
        const language = document.getElementById('lang').value;
        const objective = document.getElementById('objective').value;
        const res = await fetch('/first-login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ language, objective })
        });
        if (res.ok) {
          window.location.href = '/homepage';
        } else {
          const text = await res.text();
          statusEl.textContent = text;
        }
      });
    </script>
  </body>
</html>
